{"version":3,"sources":["services/weather-api.ts","hooks/useRequestOfficeWeather.ts","services/flights-api.ts","hooks/useRequestOfficeFlights.ts","hooks/useBestOffice.ts","components/results.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["DEFAULT_PARAMS","params","apikey","process","metric","apiClient","axios","create","baseURL","headers","getCityFiveDaysForecast","cityId","get","initialState","loading","error","data","useRequestOfficeWeather","useState","setReturn","a","prevState","responseAms","responseMad","responseBud","rawData","location","forecast","sortedBySeverityData","sort","cityForecastDataA","cityForecastDataB","Headline","Severity","Accept","getLocalAirport","lat","long","radius","type","locale","location_types","limit","active_only","lon","currentLocation","useRequestOfficeFlights","requestLatLong","Promise","resolve","navigator","geolocation","getCurrentPosition","coords","latitude","longitude","findFlights","currentLocationCode","max_stops","city","code","map","onlyFlightsResponseData","startDate","Date","startDateParameter","format","endDate","add","days","endDateParameter","fromAirportCode","toAirportCode","dateFrom","dateTo","stops","flyFrom","to","partner","v","max_stopovers","flight_type","flightsResponse","flightsFound","filter","flight","availability","seats","id","dTime","price","fly_duration","deep_link","date","fromUnixTime","duration","deepLink","flights","currentLocationAirports","locations","currentLocationAirport","all","name","result","useBestOffice","setResult","requestForecast","loadingForecast","errorForecast","requestFlights","loadingFlights","errorFlights","loadForecast","loadFlights","useEffect","finalResult","officeName","forecastByCity","f","DailyForecasts","flightsByCity","processedResults","EpochDate","flightsByDate","Temperature","Maximum","Minimum","day","Day","IconPhrase","night","Night","temperature","minimum","Value","maximum","unit","Unit","isCurrentLocation","toLowerCase","results","FlightsResults","className","key","href","target","Results","office","isCurrentLocationClassName","App","request","preferences","setPreferences","onChange","event","stopsCount","parseInt","value","onClick","Boolean","window","hostname","match","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","then","registration","unregister","catch","console","message"],"mappings":"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","file":"static/js/main.9044d09c.chunk.js","sourcesContent":["import axios from \"axios\";\n\nconst API_URL = \"https://dataservice.accuweather.com\";\nconst DEFAULT_PARAMS = {\n  params: {\n    apikey: process.env.REACT_APP_WEATHER_API_KEY,\n    metric: true,\n  }\n};\n\nconst apiClient = axios.create({\n  baseURL: API_URL,\n  headers: {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    \"Content-type\": \"application/json; charset=UTF-8\",\n  },\n});\n\nexport const getCityFiveDaysForecast = (cityId: number) =>\n  apiClient.get<any>(`/forecasts/v1/daily/5day/${cityId}`, DEFAULT_PARAMS);\n","import { useState } from \"react\";\n\nimport { getCityFiveDaysForecast } from \"../services/weather-api\";\n\nexport const AMSTERDAM = 249758;\nexport const MADRID = 308526;\nexport const BUDAPEST = 187423;\n\n// The Promise and AxiosResponse content should be specific the endpoint. Skipping just to sabe time for now\ntype ApiRequest = () => Promise<any>;\n\ninterface ApiRequestHookState {\n  loading: boolean;\n  error: Error | null;\n  data: any | null,\n}\n\ntype ApiRequestHookReturn = [\n  ApiRequest,\n  ApiRequestHookState,\n];\n\nconst initialState: ApiRequestHookState = {\n  loading: false,\n  error: null,\n  data: null,\n};\n\n// Possible improvement: This could get an array of desirable cities to gether the weather\nfunction useRequestOfficeWeather(): ApiRequestHookReturn {\n  const [{ data, loading, error }, setReturn] = useState(initialState);\n\n  async function request() {\n    try {\n      setReturn((prevState) => ({\n        ...prevState,\n        loading: true,\n      }));\n\n      const responseAms: any | null = await getCityFiveDaysForecast(AMSTERDAM);\n      const responseMad: any | null = await getCityFiveDaysForecast(MADRID);\n      const responseBud: any | null = await getCityFiveDaysForecast(BUDAPEST);\n\n      const rawData = [\n        { location: \"Amsterdam\", forecast: responseAms.data },\n        { location: \"Madrid\", forecast: responseMad.data },\n        { location: \"Budapest\", forecast: responseBud.data }\n      ];\n\n      // https://developer.accuweather.com/accuweather-forecast-api/apis/get/forecasts/v1/daily/5day/%7BlocationKey%7D\n      // The lower the number, the greater the severity\n      // So we sort Descending. The first is the best weather.\n      const sortedBySeverityData = rawData.sort((cityForecastDataA, cityForecastDataB) => {\n        return cityForecastDataB.forecast.Headline.Severity - cityForecastDataA.forecast.Headline.Severity;\n      });\n\n      setReturn((prevState) => ({\n        ...prevState,\n        data: sortedBySeverityData,\n        loading: false,\n      }));\n    } catch (error) {\n      setReturn((prevState) => ({\n        ...prevState,\n        error: error,\n        loading: false,\n      }));\n    }\n  }\n\n  return [request, { data, loading, error }];\n}\n\nexport default useRequestOfficeWeather;\n","import axios from \"axios\";\n\nconst API_URL = \"https://api.skypicker.com/\";\n\nconst apiClient = axios.create({\n  baseURL: API_URL,\n  headers: {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    \"Content-type\": \"application/json; charset=UTF-8\",\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    Accept: \"application/json\",\n  },\n});\n\n// Default to Amsterdam lat / long\nexport const getLocalAirport = (lat: number, long: number) =>\n  apiClient.get<any>(`/locations`, {\n    params: {\n      radius: 50,\n      type: \"radius\",\n      locale: \"en-US\",\n      location_types: \"airport\",\n      limit: 10,\n      active_only: true,\n      sort: \"name\",\n      lat: lat,\n      lon: long,\n    }\n  });\n\nexport const getFlightsFrom = (fromAirportCode: string, toAirportCode: string, dateFrom: string, dateTo: string, stops: number) =>\n  apiClient.get<any>(`/flights`, {\n    params: {\n      flyFrom: fromAirportCode,\n      to: toAirportCode,\n      dateFrom: dateFrom,\n      dateTo: dateTo,\n      partner: \"picky\",\n      v: 3,\n      max_stopovers: stops,\n      sort: \"price\",\n      flight_type: \"oneway\",\n      limit: 10,\n    }\n  });\n","import { useState } from \"react\";\nimport { add, format, fromUnixTime } from 'date-fns'\n\nimport { getFlightsFrom, getLocalAirport } from \"../services/flights-api\";\n\ntype FlightResponse = any;\n\nexport interface Flight {\n  id: string;\n  date: string;\n  price: number;\n  duration: string;\n  deepLink: string;\n  availability: {\n    seats: number;\n  };\n};\n\n// The Promise and AxiosResponse content should be specific the endpoint. Skipping just to sabe time for now\ntype ApiRequest = (max_stops: number) => Promise<any>;\n\ninterface ApiRequestHookState {\n  loading: boolean;\n  error: Error | null;\n  data: any | null;\n  currentLocation: string | null;\n}\n\ntype ApiRequestHookReturn = [\n  ApiRequest,\n  ApiRequestHookState,\n];\n\nconst initialState: ApiRequestHookState = {\n  loading: false,\n  error: null,\n  data: null,\n  currentLocation: null,\n};\n\nfunction useRequestOfficeFlights(): ApiRequestHookReturn {\n  const [{ data, currentLocation, loading, error }, setReturn] = useState(initialState);\n\n  async function requestLatLong(): Promise<{ latitude: number, longitude: number }> {\n    return new Promise(resolve => {\n      navigator.geolocation.getCurrentPosition(function({ coords }: any){\n        const { latitude, longitude } = coords;\n        resolve({ latitude, longitude });\n      })\n    });\n  }\n\n  function findFlights(currentLocationCode: string, max_stops: number) {\n    const citiesToBeSearched = [\n      { city: \"Amsterdam\", code: \"AMS\" },\n      { city: \"Madrid\", code: \"MAD\" },\n      { city: \"Budapest\", code: \"BUD\" },\n    ];\n\n    // This could be improved my avoiding the mutation of the variable flightsToCity. I'm not doing it now to save time.\n    return citiesToBeSearched.map(async ({ city, code }) => {\n      let onlyFlightsResponseData = [];\n\n      // TODO\n      const startDate = new Date();\n      const startDateParameter = format(startDate, \"dd/MM/yyyy\");\n      const endDate = add(startDate, { days: 4 });\n      const endDateParameter = format(endDate, \"dd/MM/yyyy\");\n\n      if (currentLocationCode !== code) {\n        const flightsResponse = await getFlightsFrom(currentLocationCode, code, startDateParameter, endDateParameter, max_stops);\n        onlyFlightsResponseData = flightsResponse.data.data;\n      }\n\n      const flightsFound = onlyFlightsResponseData\n        .filter((flight: any) => flight.availability.seats !== null)\n        .map(({\n          id,\n          dTime,\n          price,\n          fly_duration,\n          availability,\n          deep_link,\n        }: FlightResponse) => ({\n          id,\n          date: format(fromUnixTime(dTime), \"dd/MM/yyyy\"),\n          price,\n          duration: fly_duration,\n          availability,\n          deepLink: deep_link,\n        }));\n\n      return { location: city, flights: flightsFound };\n    });\n  }\n\n  async function request(max_stops: number) {\n    try {\n      setReturn((prevState) => ({\n        ...prevState,\n        loading: true,\n      }));\n\n      const coords = await requestLatLong();\n      const currentLocationAirports: any | null = await getLocalAirport(coords.latitude, coords.longitude);\n\n      // TODO: Manage error\n      const { data: { locations } } = currentLocationAirports;\n      const currentLocationAirport = locations[0];\n\n      const flights = await Promise.all(findFlights(currentLocationAirport.code, max_stops))\n\n      setReturn((prevState) => ({\n        ...prevState,\n        currentLocation: currentLocationAirport.city.name,\n        data: flights,\n        loading: false,\n      }));\n    } catch (error) {\n      setReturn((prevState) => ({\n        ...prevState,\n        error: error,\n        loading: false,\n      }));\n    }\n  }\n\n  return [request, { data, currentLocation, loading, error }];\n}\n\nexport default useRequestOfficeFlights;\n","import { useState, useEffect } from \"react\";\nimport { format, fromUnixTime } from 'date-fns'\n\nimport useRequestOfficeWeather from \"./useRequestOfficeWeather\";\nimport useRequestOfficeFlights from \"./useRequestOfficeFlights\";\nimport { Flight } from \"./useRequestOfficeFlights\";\n\nexport interface FinalResult {\n  location: string;\n  isCurrentLocation: boolean;\n  results: OfficeResults;\n}\n\nexport interface OfficeResults {\n  date: string;\n  day: string;\n  night: string;\n  temperature: {\n    minimum: number,\n    maximum: number,\n    unit: string,\n  };\n  flights: Flight[];\n};\n\ninterface HookState {\n  result: FinalResult[] | null,\n  loading: boolean,\n  error: Error | null,\n}\n\ntype HookReturn = [\n  (max_stops: number) => void,\n  HookState\n];\n\nconst initialState: HookState = {\n  result: null,\n  loading: false,\n  error: null,\n};\n\nfunction useBestOffice(): HookReturn {\n  const [ { result, loading, error }, setResult ] = useState(initialState);\n\n  const [ requestForecast, { data: forecast, loading: loadingForecast, error: errorForecast } ] = useRequestOfficeWeather();\n  const [ requestFlights, { data: flights, currentLocation, loading: loadingFlights, error: errorFlights } ] = useRequestOfficeFlights();\n\n  async function loadForecast() {\n    if (!loadingForecast && !errorForecast) {\n      await requestForecast();\n    }\n  }\n\n  async function loadFlights(max_stops: number) {\n    if (!loadingFlights && !errorFlights) {\n      await requestFlights(max_stops);\n    }\n  }\n\n  useEffect(\n    function processWeatherAndFlights() {\n      if (forecast && flights) {\n        const finalResult: FinalResult[] = [\"Amsterdam\", \"Budapest\", \"Madrid\"].map((officeName: string) => {\n          const forecastByCity = forecast.filter((f: any) => f.location === officeName)[0].forecast.DailyForecasts;\n          const flightsByCity = flights.filter((flight: any) => flight.location === officeName)[0].flights;\n\n          const processedResults = forecastByCity.map((forecast: any) => {\n            const date = format(fromUnixTime(forecast.EpochDate), \"dd/MM/yyyy\");\n            const flightsByDate = flightsByCity.filter((flight: any) => flight.date === date);\n            const { Maximum, Minimum } = forecast.Temperature;\n\n            return {\n              date: date,\n              day: forecast.Day.IconPhrase,\n              night: forecast.Night.IconPhrase,\n              temperature: {\n                minimum: Minimum.Value,\n                maximum: Maximum.Value,\n                unit: Maximum.Unit,\n              },\n              flights: flightsByDate,\n            }\n          });\n\n          const isCurrentLocation = currentLocation ? (currentLocation.toLowerCase() === officeName.toLowerCase()) : false;\n\n          return {\n            location: officeName,\n            results: processedResults,\n            isCurrentLocation,\n          }\n        });\n\n        setResult((prevState) => ({\n          ...prevState,\n          result: finalResult,\n          loading: false,\n        }));\n      }\n    },\n    [currentLocation, forecast, flights]\n  );\n\n  async function request(max_stops: number) {\n    try {\n      setResult((prevState) => ({\n        ...prevState,\n        loading: true,\n      }));\n\n      await loadForecast();\n      await loadFlights(max_stops);\n    } catch (error) {\n      setResult((prevState) => ({\n        ...prevState,\n        error: error,\n        loading: false,\n      }));\n    }\n  }\n\n  return [request, { result, loading: (loading || loadingFlights || loadingForecast), error }];\n}\n\nexport default useBestOffice;\n","import React from \"react\";\n\nimport { FinalResult, OfficeResults } from \"../hooks/useBestOffice\";\nimport { Flight } from \"../hooks/useRequestOfficeFlights\";\n\nimport \"./results.scss\";\n\ninterface ResultsProps {\n  loading: boolean;\n  result: FinalResult[] | null;\n};\n\nfunction FlightsResults({ flights }: {flights: Flight[]}) {\n  if (!flights) {\n    return (<div>No flights found.</div>);\n  }\n\n  return (\n    <div className=\"flights\">\n      {flights.map((flight: Flight) => (\n        <div key={flight.id} className=\"flight-info\">\n          <p><em>Price:</em> ${flight.price}</p>\n          <p><em>Duration:</em> {flight.duration}</p>\n          <p><em>Available seats:</em> {flight.availability.seats}</p>\n          <p>{flight.deepLink && <a href={flight.deepLink} target=\"_new\">Book flight</a>}</p>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nfunction Results({ result, loading }: ResultsProps) {\n  if (!result || loading) {\n    return (\n      <section className=\"results loading\">\n        Loading...\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"results\">\n      {result.map((office: any) => {\n        const isCurrentLocationClassName = office.isCurrentLocation ? \"current-location\" : \"\";\n\n        return (\n          <div key={office.location} className={`office-result ${isCurrentLocationClassName}`}>\n            <h2>{office.location}</h2>\n            <section className=\"results\">\n              {office.results.map((result: OfficeResults) => (\n                <div key={result.date} className=\"day\">\n                  <p className=\"date\">{result.date}</p>\n                  <p className=\"day-forecast\">Day: {result.day}</p>\n                  <p className=\"night-forecast\">Night: {result.night}</p>\n                  <p className=\"temp-forecast\">{result.temperature.maximum}° / {result.temperature.minimum}°</p>\n                  {office.isCurrentLocation ? <p>Not showing flights for your current location</p> : <FlightsResults flights={result.flights} />}\n                </div>\n              ))}\n            </section>\n          </div>\n        )\n      })}\n    </section>\n  );\n}\n\nexport default Results;\n","import React, { useEffect, useState } from 'react';\n\nimport useBestOffice from \"./hooks/useBestOffice\";\nimport Results from \"./components/results\";\n\nimport './App.scss';\n\ninterface MainState {\n  max_stops: number;\n}\n\nconst initialState: MainState = {\n  max_stops: 0,\n};\n\nfunction App() {\n  const [ request, { result, loading, error } ] = useBestOffice();\n  const [ preferences, setPreferences ] = useState(initialState);\n\n  useEffect(\n    function loadBestOffice() {\n      if (!result && !loading && !error) {\n        request(preferences.max_stops);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [ preferences, result, loading, error ]\n  );\n\n  function updatePreferences(stopsCount: number) {\n    setPreferences(prevState => ({\n      ...prevState,\n      max_stops: stopsCount,\n    }));\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"preferences\">\n        <label>Number of stops:</label>\n        <input type=\"number\" onChange={event => updatePreferences(parseInt(event.target.value))} value={preferences.max_stops} />\n        <button onClick={() => request(preferences.max_stops)}>Update search</button>\n      </div>\n      <Results result={result} loading={loading} />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}